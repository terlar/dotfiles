#!/usr/bin/env bash
set -eu
set -o pipefail

gen_entries() {
	echo cancel
	pactl list short sinks | awk '{ print $1" "$2 }'
}

main() {
	local prompt='pulseaudio output sink'
	local sel

	# Call menu
	sel="$(gen_entries \
		| rofi -dmenu -p "${prompt}:" -a 0 -no-custom \
		| awk '{print $1}')"

	# Call command
	case "${sel}" in
		cancel) true;;
		*) pactl set-default-sink "${sel}";;
	esac
}

main "$@"
