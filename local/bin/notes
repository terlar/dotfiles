#!/usr/bin/env bash
initialize() {
	local flags=()

	while true ; do
		case "$1" in
			-n)
				flags+=(-n)
				shift 1
			;;
			*)
				break
			;;
		esac
	done

	dir=${NOTES:=$HOME/notes}

	local oldifs fileArray fileArrayLen

	oldifs=$IFS
	IFS=$'\n'
	fileArray=($(grep -lr "$@" $dir))
	IFS=$oldifs
	fileArrayLen=${#fileArray[@]}

	for (( i=0; i < ${fileArrayLen}; i++ )); do
		echo "${fileArray[$i]}"
		preview ${flags[@]} "${fileArray[$i]}"
	done
}

initialize "$@"
