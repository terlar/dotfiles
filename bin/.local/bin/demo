#!/usr/bin/env bash
[[ "${TRACE}" ]] && set -x
set -eu
set -o pipefail

main() {
	local port="${1-80}"
	local subdomain="${2-$USER-${PWD##*/}}"
	local username="$3"
	local password="$4"

	if [ -n "$username"  ] && [ -n "$password" ]; then
		local httpauth="-httpauth=${username}:${password}"
	fi

	ngrok http -subdomain="$subdomain""$httpauth" "$port"
}

main "$@"
